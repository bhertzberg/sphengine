<!DOCTYPE html>
<html lang = "en">
<head>
    <meta charset = "UTF-8">
    <meta name = "viewport" content = "width=devide-width", initial-scale = "1.0">
    <title>Sphengine JSON Generator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class = "form-container">
        <hi>Generate config JSON for your sphere engine project</hi>
        <form id = "operator-inputs">
            <label for="spheng_id">Sphere Engine Workspace Project ID</label>
            <input type = "text" id = "spheng_id" required> <br>

            <label for = "extract">Do you want to extract any files from the workspace?</label>
            <input type = "checkbox" id = "extract" onchange="toggleExtractFilesInput()"><br>

            <label for="extract_files" id="extract_files_label" style="display:none;">Enter files to extract in comma separated list</label>
            <input type="text" id = "extract_files" style ="display:none" placeholder="e.g., main.py, test.py"><br>


            <label for = "custom">Do you need custom input files from metadata?</label>
            <input type = "checkbox" id = "custom" onchange="toggleCustomFilesInput()"><br>

            <label for="custom_files" id="custom_files_label" style ="display:none;">Enter custom files in comma separated list</label>
            <input type="text" id = "custom_files" style ="display:none" placeholder="e.g., metadata.sql_query, metadata.database"><br>

            <label for="custom_file_names" id="custom_files_names_label" style ="display:none;">Enter the names of your custom files in comma separated list</label>
            <input type="text" id = "custom_file_names" style ="display:none" placeholder="e.g., metadata.sql_query, metadata.database"><br>

            <button type="button" onclick="generateJson()">Generate JSON</button>
        </form>

        <div id="json-output"></div>

        <button id="copy-button" onclick="copyJson()">Copy JSON</button>

    </div>

    <script>
        function toggleExtractFilesInput(){
            const extractCheckbox = document.getElementById("extract");
            const extractFilesInput = document.getElementById("extract_files");
            const extractFilesLabel = document.getElementById("extract_files_label");
            if(extractCheckbox.checked){
                extractFilesInput.style.display = "block"
                extractFilesLabel.style.display = "block"
            } else {
                extractFilesInput.style.display = "none"
                extractFilesLabel.style.display = "none"
            }
        }
        function toggleCustomFilesInput(){
            const customCheckbox = document.getElementById("custom");
            const customFilesInput = document.getElementById("custom_files");
            const customFilesLabel = document.getElementById("custom_files_label");

            if(customCheckbox.checked){
                customFilesInput.style.display = "block"
                customFilesLabel.style.display = "block"
            } else {
                customFilesInput.style.display = "none"
                customFilesLabel.style.display = "none"
            }
        }
        function generateJson() {
            const sphengId = document.getElementById("spheng_id").value;
            const extract = document.getElementById("extract").checked;
            const extractFiles = document.getElementById("extract_files").value;
            const custom = document.getElementById("custom").checked;
            const customFiles = document.getElementById("custom_files").value;

            const jsonData = {
                spheng_id: sphengId,
                
            };

            if (extract){
                jsonData.extract_files = extractFiles.split(',').map(file =>file.trim());
            }
            if (custom) {
    jsonData.custom_files = customFiles.split(',').map(file => ({
        taskDataPath: file.trim()
    }));
}

            document.getElementById("json-output").textContent = JSON.stringify(jsonData, null, 2)
        }

        function copyJson() {
            const jsonText = document.getElementById("json-output").textContent;
            navigator.clipboard.writeText(jsonText)
                .then(() => {
                    alert("JSON copied to clipboard!");
                })
                .catch((err) => {
                    alert("Failed to copy JSON: " + err);
                });
        }
    </script>
</body>
</html>